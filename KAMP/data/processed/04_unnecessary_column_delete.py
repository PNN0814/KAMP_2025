"""
실행법
    - 1. 프로젝트의 ROOT 폴더로 이동 | ~/KAMP
    - 2. cmd에 코드 실행           | python -m data.processed.04_unnecessary_column_delete
"""

"""
불필요 컬럼 제거 (Unnecessary Column Deletion)
    - 학습 및 시각화 단계에서 사용되지 않는 컬럼 제거
    - 모델 입력 피처 및 비교 기준 데이터만 남겨
      그래프 시각화 및 예측 모델 학습에 필요한 최소 형태로 정제함
"""

"""
Q. 제거 대상
    1. Time (시간)
    2. DoW (요일)
    3. T일~T+4 예상 수주량 (예측 결과)
    
Q. 유지 대상
    - Product_Number
    - T일~T+4 예정 수주량
    - 작년 T일~T+4 예정 수주량
    - Temperature, Humidity (센서 데이터)
    - Date
"""

import os
import pandas as pd

# 공통 경로 설정 불러오기
from data.common import RESULT_DIR

#####################################################################
# 파일 경로 세팅
#####################################################################

file_path = os.path.join(RESULT_DIR, "03_전처리_이상치_제거.csv")
output_path = os.path.join(RESULT_DIR, "04_전처리_불필요컬럼_제거.csv")

#####################################################################
# 데이터 로드
#####################################################################

df = pd.read_csv(file_path, encoding="utf-8-sig")

print(f"데이터 로드 완료 / 행 개수 : {df.shape[0]}, 열 개수 : {df.shape[1]}")

#####################################################################
# 제거 대상 컬럼 목록 정의
#####################################################################

drop_columns = [
    "Time", "DoW",
    "T일 예상 수주량", "T+1일 예상 수주량", "T+2일 예상 수주량",
    "T+3일 예상 수주량", "T+4일 예상 수주량"
]

#####################################################################
# 실제 제거 수행
#####################################################################

# 제거 대상 컬럼 목록 중 실제 데이터에 존재하는 컬럼만 추출
existing_drop_cols = []
for col in drop_columns:
    if col in df.columns:
        existing_drop_cols.append(col)

# 존재하는 컬럼만 제거
if existing_drop_cols:
    df.drop(columns=existing_drop_cols, inplace=True)
    print(f"제거된 불필요 컬럼 : {existing_drop_cols}")
else:
    print("제거할 대상 컬럼이 없습니다. (이미 정제된 상태일 수 있음)")

#####################################################################
# 최종 남은 컬럼 확인
#####################################################################

print(f"컬럼 제거 완료 후 남은 컬럼 수 : {df.shape[1]}")
print(f"남은 컬럼 목록 :\n{df.columns.tolist()}")

#####################################################################
# 결과 저장
#####################################################################

df.to_csv(output_path, index=False, encoding="utf-8-sig")
print(f"불필요 컬럼 제거 완료 / 결과 저장 경로: {output_path}")

"""
결과 분석
    - 시간/요일 데이터 제거 완료
    - 예측 결과(T~T+4 예상 수주량) 컬럼 제거 완료
    - Temperature / Humidity 센서 데이터 유지됨
    - 총 13개 컬럼 유지 (학습용 + 센서 포함 데이터셋)
"""
